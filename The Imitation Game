package com.company;

import java.util.*;
import java.util.concurrent.atomic.AtomicInteger;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class Main {

    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);

        String message = scanner.nextLine();

        String command;
        while (!"Decode".equals(command = scanner.nextLine())) {
            String[] commandArray = command.split("\\|"); // Split the command into parts so we can use them properly

            // Check if the command begins with 'Move'
            if (commandArray[0].equals("Move")) {

                int numberOfLetters = Integer.parseInt(commandArray[1]);

                // Move the first n letters to the back of the string
                // Convert the string to stringBuilder to modify it easily
                StringBuilder modifyString = new StringBuilder(message);

                while ((numberOfLetters--) > 0) {
                    char deletedSymbol = modifyString.charAt(0);
                    modifyString.deleteCharAt(0); // Delete the symbol
                    modifyString.append(deletedSymbol); // Insert it at the back of the string
                }
                message = modifyString.toString(); // Update the string
            }
            // Check if the command begins with 'Insert'
            else if (commandArray[0].equals("Insert")) {

                int index = Integer.parseInt(commandArray[1]);
                String value = commandArray[2];

                // Check if the index is valid
                if (index >= 0 && index <= message.length()) {
                    StringBuilder newMessage = new StringBuilder();
                    newMessage.append(message, 0, index);
                    newMessage.append(value);
                    newMessage.append(message.substring(index));
                    message = newMessage.toString(); // Update the string
                }
            }
            // Check if the command begins with 'ChangeAll'
            else if (commandArray[0].equals("ChangeAll")) {

                String substring = commandArray[1];
                String replacement = commandArray[2];

                if (message.contains(substring)) {
                    message = message.replace(substring, replacement);
                }
            }
        }
        System.out.println("The decrypted message is: " + message);
    }
}
